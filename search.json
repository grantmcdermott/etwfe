[{"path":"http://grantmcdermott.com/etwfe/articles/etwfe.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Introduction to etwfe","text":"One canonical research designs social scientists -called “differences--differences” () design.1 Historically, way applied researchers estimated form two-way fixed effects (TWFE) regression. TWFE basically just interaction effect treatment time, might look something like following R: type regression easy run interpret, long time everyone happy. good last. slew smart studies began appearing early 2020s, demonstrating things weren’t quite simple. Among things, core interaction term standard TWFE can provide biased estimate true treatment effect rollout treatment staggered time (common occurence). Fortunately, just econometricians taking away one favourite tools, kind enough replace new ones. Among , proposed approach Wooldridge (2021) noteworthy. idea might paraphrased stating problem TWFE first place, weren’t enough. say instead including single treatment × time interaction, saturate model possible interactions treatment time variables, including treament cohorts, well covariates. Wooldridge (2021) refers idea extended TWFE—, ETWFE—package takes name. Wooldridge ETWFE solution intuitive elegant. also rather tedious error prone code manually. etwfe package aims simplify process providing convenience functions work . etwfe thus provides R equivalent JWDID Stata module , indeed, shares core design elements.","code":"lm(y ~ treat * time, data)"},{"path":"http://grantmcdermott.com/etwfe/articles/etwfe.html","id":"dataset","dir":"Articles","previous_headings":"","what":"Dataset","title":"Introduction to etwfe","text":"demonstrate core functionality etwfe, ’ll use mpdta dataset US teen employment *package (’ll need install separately). examples follow, goal estimate effect treatment treat (log) employment lemp. Notice panel ID county level countyreal, treatment staggered across cohorts first.treat group counties treated time. addition staggered treatment effects, also observe (log) population lpop potential, time-invariant control.2","code":"# install.packages(\"did\") data(\"mpdta\", package = \"did\") head(mpdta) #>     year countyreal     lpop     lemp first.treat treat #> 866 2003       8001 5.896761 8.461469        2007     1 #> 841 2004       8001 5.896761 8.336870        2007     1 #> 842 2005       8001 5.896761 8.340217        2007     1 #> 819 2006       8001 5.896761 8.378161        2007     1 #> 827 2007       8001 5.896761 8.487352        2007     1 #> 937 2003       8019 2.232377 4.997212        2007     1"},{"path":"http://grantmcdermott.com/etwfe/articles/etwfe.html","id":"basic-useage","dir":"Articles","previous_headings":"","what":"Basic useage","title":"Introduction to etwfe","text":"Okay, let’s load etwfe work basic functionality. Given package name, won’t surprise know key estimating function etwfe(). ’s look example dataset. things say etwfe() argument choices function options, ’ll leave details aside bit later. Right now, just know arguments required except vcov (though generally recommend , since probably want cluster standard errors individual unit level). Let’s take look model object. etwfe() done underneath hood construct treatment dummy variable .Dtreat saturated together variables interest set multiway interaction terms.3 may also noticed etwfe() call returns standard fixest object, since uses perform underlying estimation. associated methods functions fixest package thus compatible model object. example, *plot raw regression coefficients fixest::coefplot(), print nice regression table fixest::etable(). However, raw coefficients etwfe() estimation particularly meaningful . Remember complex multiway interaction terms probably hard interpret . , probably want aggregate along dimension interest instead (e.g., groups time, event study). natural way perform aggregations recovering appropriate marginal effects. etwfe package provides another convenience function : emfx(), thin(ish) wrapper around marginaleffects::marginaleffects(). example, can recover average treatment effect follows. , can recover dynamic treatment effects la event study invoking type argument. types aggregations include “calendar” (: treatment year effects) “group” (: treatment cohort).","code":"library(etwfe)  mod =   etwfe(     fml  = lemp ~ lpop, # outcome ~ (time-invariant) controls     tvar = year,        # time variable     gvar = first.treat, # group variable     data = mpdta,       # dataset     vcov = ~countyreal  # vcov adjustment (here: clustered)     ) mod #> OLS estimation, Dep. Var.: lemp #> Observations: 2,500  #> Fixed-effects: first.treat: 4,  year: 5 #> Varying slopes: lpop (first.treat: 4),  lpop (year: 5) #> Standard-errors: Clustered (countyreal)  #>                                               Estimate Std. Error   t value #> .Dtreat:first.treat::2004:year::2004         -0.021248   0.021728 -0.977890 #> .Dtreat:first.treat::2004:year::2005         -0.081850   0.027375 -2.989963 #> .Dtreat:first.treat::2004:year::2006         -0.137870   0.030795 -4.477097 #> .Dtreat:first.treat::2004:year::2007         -0.109539   0.032322 -3.389024 #> .Dtreat:first.treat::2006:year::2006          0.002537   0.018883  0.134344 #> .Dtreat:first.treat::2006:year::2007         -0.045093   0.021987 -2.050907 #> .Dtreat:first.treat::2007:year::2007         -0.045955   0.017975 -2.556568 #> .Dtreat:first.treat::2004:year::2004:lpop_dm  0.004628   0.017584  0.263184 #> .Dtreat:first.treat::2004:year::2005:lpop_dm  0.025113   0.017904  1.402661 #> .Dtreat:first.treat::2004:year::2006:lpop_dm  0.050735   0.021070  2.407884 #> .Dtreat:first.treat::2004:year::2007:lpop_dm  0.011250   0.026617  0.422648 #> .Dtreat:first.treat::2006:year::2006:lpop_dm  0.038935   0.016472  2.363731 #> .Dtreat:first.treat::2006:year::2007:lpop_dm  0.038060   0.022477  1.693276 #> .Dtreat:first.treat::2007:year::2007:lpop_dm -0.019835   0.016198 -1.224528 #>                                                Pr(>|t|)     #> .Dtreat:first.treat::2004:year::2004         3.2860e-01     #> .Dtreat:first.treat::2004:year::2005         2.9279e-03 **  #> .Dtreat:first.treat::2004:year::2006         9.3851e-06 *** #> .Dtreat:first.treat::2004:year::2007         7.5694e-04 *** #> .Dtreat:first.treat::2006:year::2006         8.9318e-01     #> .Dtreat:first.treat::2006:year::2007         4.0798e-02 *   #> .Dtreat:first.treat::2007:year::2007         1.0866e-02 *   #> .Dtreat:first.treat::2004:year::2004:lpop_dm 7.9252e-01     #> .Dtreat:first.treat::2004:year::2005:lpop_dm 1.6134e-01     #> .Dtreat:first.treat::2004:year::2006:lpop_dm 1.6407e-02 *   #> .Dtreat:first.treat::2004:year::2007:lpop_dm 6.7273e-01     #> .Dtreat:first.treat::2006:year::2006:lpop_dm 1.8474e-02 *   #> .Dtreat:first.treat::2006:year::2007:lpop_dm 9.1027e-02 .   #> .Dtreat:first.treat::2007:year::2007:lpop_dm 2.2133e-01     #> ... 10 variables were removed because of collinearity (.Dtreat:first.treat::2006:year::2004, .Dtreat:first.treat::2006:year::2005 and 8 others [full set in $collin.var]) #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #> RMSE: 0.537131     Adj. R2: 0.87167  #>                  Within R2: 8.449e-4 emfx(mod) #>      Term    Contrast .Dtreat   Effect Std. Error z value   Pr(>|z|)    2.5 % #> 1 .Dtreat mean(dY/dX)       1 -0.05063     0.0125   -4.05 5.1167e-05 -0.07513 #>     97.5 % #> 1 -0.02613 #>  #> Model type:  etwfe  #> Prediction type:  response emfx(mod, type = \"event\") #>      Term    Contrast event   Effect Std. Error z value   Pr(>|z|)    2.5 % #> 1 .Dtreat mean(dY/dX)     0 -0.03321    0.01337  -2.484 0.01297951 -0.05941 #> 2 .Dtreat mean(dY/dX)     1 -0.05735    0.01715  -3.343 0.00082830 -0.09097 #> 3 .Dtreat mean(dY/dX)     2 -0.13787    0.03079  -4.477 7.5665e-06 -0.19823 #> 4 .Dtreat mean(dY/dX)     3 -0.10954    0.03232  -3.389 0.00070142 -0.17289 #>     97.5 % #> 1 -0.00701 #> 2 -0.02373 #> 3 -0.07751 #> 4 -0.04619 #>  #> Model type:  etwfe  #> Prediction type:  response"},{"path":"http://grantmcdermott.com/etwfe/articles/etwfe.html","id":"other-families","dir":"Articles","previous_headings":"","what":"Other families","title":"Introduction to etwfe","text":"key feature ETWFE method proposed Wooldridge (2021) supports nonlinear model (distribution / link) families. ’s brief example, recast earlier event-study Poisson regression.","code":"mpdta$emp = exp(mpdta$lemp)  etwfe(   emp ~ lpop, tvar = year, gvar = first.treat, data = mpdta, vcov = ~countyreal,   family = \"poisson\"   ) |>   emfx(\"event\") #>      Term    Contrast event  Effect Std. Error  z value   Pr(>|z|)   2.5 % #> 1 .Dtreat mean(dY/dX)     0 -22.849      16.24 -1.40674 0.15950581  -54.68 #> 2 .Dtreat mean(dY/dX)     1   3.654      43.48  0.08405 0.93301382  -81.56 #> 3 .Dtreat mean(dY/dX)     2 -71.521      21.28 -3.36144 0.00077537 -113.22 #> 4 .Dtreat mean(dY/dX)     3 -97.798      26.50 -3.69045 0.00022386 -149.74 #>    97.5 % #> 1   8.986 #> 2  88.865 #> 3 -29.819 #> 4 -45.858 #>  #> Model type:  etwfe  #> Prediction type:  response"},{"path":"http://grantmcdermott.com/etwfe/articles/etwfe.html","id":"what-is-etwfe-doing-under-the-hood","dir":"Articles","previous_headings":"","what":"What is etwfe doing under the hood?","title":"Introduction to etwfe","text":"Now ’ve seen etwfe action, let’s circle back package hood. section isn’t necessary use functions. Feel free skip . review internal details help optimize different scenarios also give understanding etwfe’s default choices. ’ve stated several times, Wooldridge ETWFE approach basically involves saturataing regression interaction effects. can easily grab formula estimated model see . point, however, may notice things. first formula references several variables aren’t original dataset. obvious one .Dtreat treatment dummy. subtle one lpop_dm, demeaned (.e., group-centered) version lpop control variable. (time-invariant) control variables demeaned interacted ETWFE setting. ’s constructed dataset ahead time estimated ETWFE regression manually: regular fixest user, may noticed ’ve invoking varying slopes syntax fixed-effect slot (.e., first.treat[lpop] year[lpop]). reason part practical, part philosophical. practical perspective, factor_var[numeric_var] equivalent base R’s factor_var/numeric_var “nesting” syntax much faster high-dimensional factors.4 philosphical perspective, etwfe tries limit amount extraneous information reports users. interaction effects ETWFE framework just acting controls. relegating fixed-effects slot, can avoid polluting user’s console load extra coefficients. Nonetheless, can control behaviour fe (“fixed effects”) argument. Consider following options manual equivalents. ’ll leave pass models emfx confirm give correct aggregated treatment effects. can quickly demonstrate regression table return raw coefficients.","code":"mod$fml_all #> $linear #> lemp ~ .Dtreat:i(first.treat, i.year, ref = 0, ref2 = 2003)/lpop_dm #> <environment: 0x55d390de5c18> #>  #> $fixef #> ~first.treat + first.treat[[lpop]] + year + year[[lpop]] # First construct the dataset mpdta2 = mpdta |>   transform(     .Dtreat = as.integer(year >= first.treat & first.treat != 0),     lpop_dm = ave(lpop, first.treat, year, FUN = \\(x) x - mean(x, na.rm = TRUE))   )  # Then estimate the manual version of etwfe mod2 = fixest::feols(   lemp ~ .Dtreat:i(first.treat, i.year, ref = 0, ref2 = 2003) / lpop_dm |     first.treat[lpop] + year[lpop],   data = mpdta2,   vcov = ~countyreal ) #> The variables '.Dtreat:first.treat::2006:year::2004', '.Dtreat:first.treat::2006:year::2005' and eight others have been removed because of collinearity (see $collin.var).  # Confirm that they are the same fixest::etable('etwfe' = mod, 'manual' = mod2, signif.code = NA) #>                                                                 etwfe #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                Yes #> lpop (year)                                                       Yes #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.00084 #>  #>                                                                manual #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                Yes #> lpop (year)                                                       Yes #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.00084 # fe = \"feo\" (fixed effects only) mod_feo = etwfe(   lemp ~ lpop, tvar = year, gvar = first.treat, data = mpdta, vcov = ~countyreal,   fe = \"feo\" ) # ... which is equivalent to the manual regression mod_feo2 = fixest::feols(   lemp ~ .Dtreat:i(first.treat, i.year, ref = 0, ref2 = 2003) / lpop_dm +     lpop + i(first.treat, lpop, ref = 0) + i(year, lpop, ref = 2003) |     first.treat + year,   data = mpdta2, vcov = ~countyreal )  # fe = \"none\" mod_none = etwfe(   lemp ~ lpop, tvar = year, gvar = first.treat, data = mpdta, vcov = ~countyreal,   fe = \"none\" ) # ... which is equivalent to the manual regression mod_none2 = fixest::feols(   lemp ~ .Dtreat:i(first.treat, i.year, ref = 0, ref2 = 2003) / lpop_dm +     lpop + i(first.treat, lpop, ref = 0) + i(year, lpop, ref = 2003) +     i(first.treat, ref = 0) + i(year, ref = 2003),   data = mpdta2, vcov = ~countyreal ) fixest::etable(mod, mod2, mod_feo, mod_feo2, mod_none, mod_none2, signif.code = NA) #>                                                                   mod #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                                  #> lpop x first.treat = 2004                                             #> lpop x first.treat = 2006                                             #> lpop x first.treat = 2007                                             #> lpop x year = 2004                                                    #> lpop x year = 2005                                                    #> lpop x year = 2006                                                    #> lpop x year = 2007                                                    #> Constant                                                              #> first.treat = 2004                                                    #> first.treat = 2006                                                    #> first.treat = 2007                                                    #> year = 2004                                                           #> year = 2005                                                           #> year = 2006                                                           #> year = 2007                                                           #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                Yes #> lpop (year)                                                       Yes #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.00084 #>  #>                                                                  mod2 #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                                  #> lpop x first.treat = 2004                                             #> lpop x first.treat = 2006                                             #> lpop x first.treat = 2007                                             #> lpop x year = 2004                                                    #> lpop x year = 2005                                                    #> lpop x year = 2006                                                    #> lpop x year = 2007                                                    #> Constant                                                              #> first.treat = 2004                                                    #> first.treat = 2006                                                    #> first.treat = 2007                                                    #> year = 2004                                                           #> year = 2005                                                           #> year = 2006                                                           #> year = 2007                                                           #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                Yes #> lpop (year)                                                       Yes #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.00084 #>  #>                                                               mod_feo #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                   1.065 (0.0218) #> lpop x first.treat = 2004                             0.0510 (0.0378) #> lpop x first.treat = 2006                            -0.0411 (0.0474) #> lpop x first.treat = 2007                             0.0555 (0.0392) #> lpop x year = 2004                                    0.0110 (0.0076) #> lpop x year = 2005                                    0.0207 (0.0081) #> lpop x year = 2006                                    0.0105 (0.0108) #> lpop x year = 2007                                    0.0209 (0.0118) #> Constant                                                              #> first.treat = 2004                                                    #> first.treat = 2006                                                    #> first.treat = 2007                                                    #> year = 2004                                                           #> year = 2005                                                           #> year = 2006                                                           #> year = 2007                                                           #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                 No #> lpop (year)                                                        No #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.86946 #>  #>                                                              mod_feo2 #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                   1.065 (0.0218) #> lpop x first.treat = 2004                             0.0510 (0.0378) #> lpop x first.treat = 2006                            -0.0411 (0.0474) #> lpop x first.treat = 2007                             0.0555 (0.0392) #> lpop x year = 2004                                    0.0110 (0.0076) #> lpop x year = 2005                                    0.0207 (0.0081) #> lpop x year = 2006                                    0.0105 (0.0108) #> lpop x year = 2007                                    0.0209 (0.0118) #> Constant                                                              #> first.treat = 2004                                                    #> first.treat = 2006                                                    #> first.treat = 2007                                                    #> year = 2004                                                           #> year = 2005                                                           #> year = 2006                                                           #> year = 2007                                                           #> Fixed-Effects:                                       ---------------- #> first.treat                                                       Yes #> year                                                              Yes #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                 No #> lpop (year)                                                        No #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                     0.86946 #>  #>                                                              mod_none #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                   1.065 (0.0218) #> lpop x first.treat = 2004                             0.0510 (0.0378) #> lpop x first.treat = 2006                            -0.0411 (0.0474) #> lpop x first.treat = 2007                             0.0555 (0.0392) #> lpop x year = 2004                                    0.0110 (0.0076) #> lpop x year = 2005                                    0.0207 (0.0081) #> lpop x year = 2006                                    0.0105 (0.0108) #> lpop x year = 2007                                    0.0209 (0.0118) #> Constant                                               2.260 (0.0881) #> first.treat = 2004                                    0.0383 (0.1538) #> first.treat = 2006                                    0.4613 (0.2130) #> first.treat = 2007                                   -0.2861 (0.1672) #> year = 2004                                          -0.0902 (0.0307) #> year = 2005                                          -0.1105 (0.0326) #> year = 2006                                          -0.0517 (0.0402) #> year = 2007                                          -0.0575 (0.0453) #> Fixed-Effects:                                       ---------------- #> first.treat                                                        No #> year                                                               No #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                 No #> lpop (year)                                                        No #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                          -- #>  #>                                                             mod_none2 #> Dependent Var.:                                                  lemp #>                                                                       #> .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217) #> .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274) #> .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308) #> .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323) #> .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189) #> .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220) #> .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211) #> .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165) #> .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225) #> .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162) #> lpop                                                   1.065 (0.0218) #> lpop x first.treat = 2004                             0.0510 (0.0378) #> lpop x first.treat = 2006                            -0.0411 (0.0474) #> lpop x first.treat = 2007                             0.0555 (0.0392) #> lpop x year = 2004                                    0.0110 (0.0076) #> lpop x year = 2005                                    0.0207 (0.0081) #> lpop x year = 2006                                    0.0105 (0.0108) #> lpop x year = 2007                                    0.0209 (0.0118) #> Constant                                               2.260 (0.0881) #> first.treat = 2004                                    0.0383 (0.1538) #> first.treat = 2006                                    0.4613 (0.2130) #> first.treat = 2007                                   -0.2861 (0.1672) #> year = 2004                                          -0.0902 (0.0307) #> year = 2005                                          -0.1105 (0.0326) #> year = 2006                                          -0.0517 (0.0402) #> year = 2007                                          -0.0575 (0.0453) #> Fixed-Effects:                                       ---------------- #> first.treat                                                        No #> year                                                               No #> Varying Slopes:                                      ---------------- #> lpop (first.treat)                                                 No #> lpop (year)                                                        No #> ________________________________________             ________________ #> S.E.: Clustered                                        by: countyreal #> Observations                                                    2,500 #> R2                                                            0.87321 #> Within R2                                                          --"},{"path":"http://grantmcdermott.com/etwfe/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Grant McDermott. Author, maintainer.","code":""},{"path":"http://grantmcdermott.com/etwfe/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"McDermott G (2022). etwfe: Convenience functions extended two-way fixed effects la Wooldridge (2021). https://github.com/grantmcdermott/etwfe, http://grantmcdermott.com/etwfe/.","code":"@Manual{,   title = {etwfe: Convenience functions for extended two-way fixed effects a la Wooldridge (2021)},   author = {Grant McDermott},   year = {2022},   note = {https://github.com/grantmcdermott/etwfe, http://grantmcdermott.com/etwfe/}, }"},{"path":"http://grantmcdermott.com/etwfe/index.html","id":"extended-two-way-fixed-effects-etwfe","dir":"","previous_headings":"","what":"Convenience functions for extended two-way fixed effects a la Wooldridge\n  (2021)","title":"Convenience functions for extended two-way fixed effects a la Wooldridge\n  (2021)","text":"goal etwfe estimate extended (Mundlak) two-way fixed effects la Wooldridge (2021). Briefly, Wooldridge proposes set saturated interaction effects overcome potential bias problems vanilla TWFE difference--differences designs. Wooldridge solution intuitive elegant, rather tedious error prone code manually. etwfe package aims simplify process providing convenience functions work .","code":""},{"path":"http://grantmcdermott.com/etwfe/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Convenience functions for extended two-way fixed effects a la Wooldridge\n  (2021)","text":"can install development version etwfe GitHub:","code":"# install.packages(\"remotes\") remotes::install_github(\"grantmcdermott/etwfe\")"},{"path":"http://grantmcdermott.com/etwfe/index.html","id":"quickstart-example","dir":"","previous_headings":"","what":"Quickstart example","title":"Convenience functions for extended two-way fixed effects a la Wooldridge\n  (2021)","text":"detailed walkthrough package provided introductory vignette. See vignette(\"etwfe\"). ’s quickstart example demonstrate basic syntax.","code":"library(etwfe)  # install.packages(\"did\") data(\"mpdta\", package = \"did\") head(mpdta) #>     year countyreal     lpop     lemp first.treat treat #> 866 2003       8001 5.896761 8.461469        2007     1 #> 841 2004       8001 5.896761 8.336870        2007     1 #> 842 2005       8001 5.896761 8.340217        2007     1 #> 819 2006       8001 5.896761 8.378161        2007     1 #> 827 2007       8001 5.896761 8.487352        2007     1 #> 937 2003       8019 2.232377 4.997212        2007     1  # Estimate the model mod =   etwfe(     fml  = lemp ~ lpop, # outcome ~ controls     tvar = year,        # time variable     gvar = first.treat, # group variable     data = mpdta,       # dataset     vcov = ~countyreal  # vcov adjustment (here: clustered)     ) mod #> OLS estimation, Dep. Var.: lemp #> Observations: 2,500  #> Fixed-effects: first.treat: 4,  year: 5 #> Varying slopes: lpop (first.treat: 4),  lpop (year: 5) #> Standard-errors: Clustered (countyreal)  #>                                               Estimate Std. Error   t value   Pr(>|t|)     #> .Dtreat:first.treat::2004:year::2004         -0.021248   0.021728 -0.977890 3.2860e-01     #> .Dtreat:first.treat::2004:year::2005         -0.081850   0.027375 -2.989963 2.9279e-03 **  #> .Dtreat:first.treat::2004:year::2006         -0.137870   0.030795 -4.477097 9.3851e-06 *** #> .Dtreat:first.treat::2004:year::2007         -0.109539   0.032322 -3.389024 7.5694e-04 *** #> .Dtreat:first.treat::2006:year::2006          0.002537   0.018883  0.134344 8.9318e-01     #> .Dtreat:first.treat::2006:year::2007         -0.045093   0.021987 -2.050907 4.0798e-02 *   #> .Dtreat:first.treat::2007:year::2007         -0.045955   0.017975 -2.556568 1.0866e-02 *   #> .Dtreat:first.treat::2004:year::2004:lpop_dm  0.004628   0.017584  0.263184 7.9252e-01     #> .Dtreat:first.treat::2004:year::2005:lpop_dm  0.025113   0.017904  1.402661 1.6134e-01     #> .Dtreat:first.treat::2004:year::2006:lpop_dm  0.050735   0.021070  2.407884 1.6407e-02 *   #> .Dtreat:first.treat::2004:year::2007:lpop_dm  0.011250   0.026617  0.422648 6.7273e-01     #> .Dtreat:first.treat::2006:year::2006:lpop_dm  0.038935   0.016472  2.363731 1.8474e-02 *   #> .Dtreat:first.treat::2006:year::2007:lpop_dm  0.038060   0.022477  1.693276 9.1027e-02 .   #> .Dtreat:first.treat::2007:year::2007:lpop_dm -0.019835   0.016198 -1.224528 2.2133e-01     #> ... 10 variables were removed because of collinearity (.Dtreat:first.treat::2006:year::2004, .Dtreat:first.treat::2006:year::2005 and 8 others [full set in $collin.var]) #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #> RMSE: 0.537131     Adj. R2: 0.87167  #>                  Within R2: 8.449e-4  # Event-study treatment effects emfx(mod, type = \"event\") #>      Term    Contrast event   Effect Std. Error z value   Pr(>|z|)    2.5 %   97.5 % #> 1 .Dtreat mean(dY/dX)     0 -0.03321    0.01337  -2.484 0.01297951 -0.05941 -0.00701 #> 2 .Dtreat mean(dY/dX)     1 -0.05735    0.01715  -3.343 0.00082830 -0.09097 -0.02373 #> 3 .Dtreat mean(dY/dX)     2 -0.13787    0.03079  -4.477 7.5665e-06 -0.19823 -0.07751 #> 4 .Dtreat mean(dY/dX)     3 -0.10954    0.03232  -3.389 0.00070142 -0.17289 -0.04619 #>  #> Model type:  etwfe  #> Prediction type:  response"},{"path":"http://grantmcdermott.com/etwfe/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"Convenience functions for extended two-way fixed effects a la Wooldridge\n  (2021)","text":"Jeffrey Wooldridge underlying theory behind ETWFE. Laurent Bergé (fixest) Vincent Arel-Bundock (marginaleffects) maintaining two wonderful R packages heavy lifting hood . Fernando Rios-Avila JWDID Stata module, provided welcome foil unit testing whose elegant design helped inform choices R equivalent.","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/emfx.html","id":null,"dir":"Reference","previous_headings":"","what":"Post-estimation treatment effects for an ETWFE regressions. — emfx","title":"Post-estimation treatment effects for an ETWFE regressions. — emfx","text":"Post-estimation treatment effects ETWFE regressions.","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/emfx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post-estimation treatment effects for an ETWFE regressions. — emfx","text":"","code":"emfx(   object,   type = c(\"simple\", \"group\", \"calendar\", \"event\"),   summary = TRUE,   ... )"},{"path":"http://grantmcdermott.com/etwfe/reference/emfx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Post-estimation treatment effects for an ETWFE regressions. — emfx","text":"object `etwfe` model object. type Character. desired type post-estimation aggregation. summary Logical. resulting marginaleffects objects passed [`summary`] returned? Defaults TRUE, mostly aesthetics reasons. ... Additional arguments passed  [`marginaleffects::marginaleffects`].","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/emfx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Post-estimation treatment effects for an ETWFE regressions. — emfx","text":"marginaleffects object.","code":""},{"path":[]},{"path":"http://grantmcdermott.com/etwfe/reference/emfx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Post-estimation treatment effects for an ETWFE regressions. — emfx","text":"","code":"# We’ll use the mpdta dataset from the did package (which you’ll need to  # install separately).  # install.packages(\"did\") data(\"mpdta\", package = \"did\")  # Run the estimation mod = etwfe(     fml  = lemp ~ lpop, # outcome ~ controls     tvar = year,        # time variable     gvar = first.treat, # group variable     data = mpdta,       # dataset     vcov = ~countyreal  # vcov adjustment (here: clustered)     ) mod #> OLS estimation, Dep. Var.: lemp #> Observations: 2,500  #> Fixed-effects: first.treat: 4,  year: 5 #> Varying slopes: lpop (first.treat: 4),  lpop (year: 5) #> Standard-errors: Clustered (countyreal)  #>                                               Estimate Std. Error   t value #> .Dtreat:first.treat::2004:year::2004         -0.021248   0.021728 -0.977890 #> .Dtreat:first.treat::2004:year::2005         -0.081850   0.027375 -2.989963 #> .Dtreat:first.treat::2004:year::2006         -0.137870   0.030795 -4.477097 #> .Dtreat:first.treat::2004:year::2007         -0.109539   0.032322 -3.389024 #> .Dtreat:first.treat::2006:year::2006          0.002537   0.018883  0.134344 #> .Dtreat:first.treat::2006:year::2007         -0.045093   0.021987 -2.050907 #> .Dtreat:first.treat::2007:year::2007         -0.045955   0.017975 -2.556568 #> .Dtreat:first.treat::2004:year::2004:lpop_dm  0.004628   0.017584  0.263184 #> .Dtreat:first.treat::2004:year::2005:lpop_dm  0.025113   0.017904  1.402661 #> .Dtreat:first.treat::2004:year::2006:lpop_dm  0.050735   0.021070  2.407884 #> .Dtreat:first.treat::2004:year::2007:lpop_dm  0.011250   0.026617  0.422648 #> .Dtreat:first.treat::2006:year::2006:lpop_dm  0.038935   0.016472  2.363731 #> .Dtreat:first.treat::2006:year::2007:lpop_dm  0.038060   0.022477  1.693276 #> .Dtreat:first.treat::2007:year::2007:lpop_dm -0.019835   0.016198 -1.224528 #>                                                Pr(>|t|)     #> .Dtreat:first.treat::2004:year::2004         3.2860e-01     #> .Dtreat:first.treat::2004:year::2005         2.9279e-03 **  #> .Dtreat:first.treat::2004:year::2006         9.3851e-06 *** #> .Dtreat:first.treat::2004:year::2007         7.5694e-04 *** #> .Dtreat:first.treat::2006:year::2006         8.9318e-01     #> .Dtreat:first.treat::2006:year::2007         4.0798e-02 *   #> .Dtreat:first.treat::2007:year::2007         1.0866e-02 *   #> .Dtreat:first.treat::2004:year::2004:lpop_dm 7.9252e-01     #> .Dtreat:first.treat::2004:year::2005:lpop_dm 1.6134e-01     #> .Dtreat:first.treat::2004:year::2006:lpop_dm 1.6407e-02 *   #> .Dtreat:first.treat::2004:year::2007:lpop_dm 6.7273e-01     #> .Dtreat:first.treat::2006:year::2006:lpop_dm 1.8474e-02 *   #> .Dtreat:first.treat::2006:year::2007:lpop_dm 9.1027e-02 .   #> .Dtreat:first.treat::2007:year::2007:lpop_dm 2.2133e-01     #> ... 10 variables were removed because of collinearity (.Dtreat:first.treat::2006:year::2004, .Dtreat:first.treat::2006:year::2005 and 8 others [full set in $collin.var]) #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #> RMSE: 0.537131     Adj. R2: 0.87167  #>                  Within R2: 8.449e-4  # We can recover a variety of treatment effects of interest with the  # complementary emfx() function. For example: emfx(mod, type = \"event\") #>      Term    Contrast event   Effect Std. Error z value   Pr(>|z|)    2.5 % #> 1 .Dtreat mean(dY/dX)     0 -0.03321    0.01337  -2.484 0.01297951 -0.05941 #> 2 .Dtreat mean(dY/dX)     1 -0.05735    0.01715  -3.343 0.00082830 -0.09097 #> 3 .Dtreat mean(dY/dX)     2 -0.13787    0.03079  -4.477 7.5665e-06 -0.19823 #> 4 .Dtreat mean(dY/dX)     3 -0.10954    0.03232  -3.389 0.00070142 -0.17289 #>     97.5 % #> 1 -0.00701 #> 2 -0.02373 #> 3 -0.07751 #> 4 -0.04619 #>  #> Model type:  etwfe  #> Prediction type:  response"},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":null,"dir":"Reference","previous_headings":"","what":"Extended two-way fixed effects — etwfe","title":"Extended two-way fixed effects — etwfe","text":"Extended two-way fixed effects","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extended two-way fixed effects — etwfe","text":"","code":"etwfe(   fml = NULL,   ivar = NULL,   tvar = NULL,   gvar = NULL,   data = NULL,   tref = NULL,   gref = NULL,   cgroup = c(\"notyet\", \"never\"),   fe = c(\"vs\", \"feo\", \"none\"),   family = NULL,   ... )"},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extended two-way fixed effects — etwfe","text":"fml formula outcome (lhs) time-constant controls  variables (rhs), e.g. `y ~ x1 + x2`. Please note time-varying controls supported. Similarly, additional controls required,  rhs must take value zero, e.g. `y ~ 0`. ivar Index variable. Can string (e.g., \"country\")  expression (e.g., country). Leaving NULL (default) result group-level fixed effects used, efficient necessary  nonlinear models (see `family` argument ). tvar Time variable. Can string (e.g., \"year\") expression (e.g., year). gvar Group variable. Can either string (e.g., \"first_treated\")  expression (e.g., first_treated). staggered treatment setting,  group variable typically denotes treatment cohort. data data frame want run ETWFE . tref Optional reference value `tvar`. Defaults minimum  value (.e., first time period observed dataset). gref Optional reference value `gvar`. need  provide `gvar` variable well specified. providing  explicit reference value can useful/necessary desired control  group takes unusual value. cgroup control group wish use  estimating treatment effects. Either \"notyet\" treated (default) \"never\" treated. fe level fixed effects used? Defaults \"vs\"  (varying slopes), efficient terms estimation  terseness return model object. two options, \"feo\" (fixed  effects ) \"none\" (fixed effects whatsoever), trade efficiency additional information (nuisance) model parameters. Note primary treatment parameters interest remain unchanged  regardless choice. family [`family`] use estimation. Defaults NULL,  case [`fixest::feols`] used. Otherwise passed [`fixest::feglm`], valid entries include \"logit\", \"poisson\", \"negbin\". Note non-NULL family entry detected, `ivar` automatically set NULL. ... Additional arguments passed [`fixest::feols`] ( [`fixest::feglm`]). common example `vcov` argument.","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extended two-way fixed effects — etwfe","text":"fixest object fully saturated interaction effects.","code":""},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extended two-way fixed effects — etwfe","text":"Wooldridge, Jeffrey M. (2021). Two-Way Fixed Effects,  Two-Way Mundlak Regression, Difference--Differences Estimators. Working paper (version: August 16, 2021). Available:  http://dx.doi.org/10.2139/ssrn.3906345","code":""},{"path":[]},{"path":"http://grantmcdermott.com/etwfe/reference/etwfe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extended two-way fixed effects — etwfe","text":"","code":"# We’ll use the mpdta dataset from the did package (which you’ll need to  # install separately).  # install.packages(\"did\") data(\"mpdta\", package = \"did\")  # Run the estimation mod = etwfe(     fml  = lemp ~ lpop, # outcome ~ controls     tvar = year,        # time variable     gvar = first.treat, # group variable     data = mpdta,       # dataset     vcov = ~countyreal  # vcov adjustment (here: clustered)     ) mod #> OLS estimation, Dep. Var.: lemp #> Observations: 2,500  #> Fixed-effects: first.treat: 4,  year: 5 #> Varying slopes: lpop (first.treat: 4),  lpop (year: 5) #> Standard-errors: Clustered (countyreal)  #>                                               Estimate Std. Error   t value #> .Dtreat:first.treat::2004:year::2004         -0.021248   0.021728 -0.977890 #> .Dtreat:first.treat::2004:year::2005         -0.081850   0.027375 -2.989963 #> .Dtreat:first.treat::2004:year::2006         -0.137870   0.030795 -4.477097 #> .Dtreat:first.treat::2004:year::2007         -0.109539   0.032322 -3.389024 #> .Dtreat:first.treat::2006:year::2006          0.002537   0.018883  0.134344 #> .Dtreat:first.treat::2006:year::2007         -0.045093   0.021987 -2.050907 #> .Dtreat:first.treat::2007:year::2007         -0.045955   0.017975 -2.556568 #> .Dtreat:first.treat::2004:year::2004:lpop_dm  0.004628   0.017584  0.263184 #> .Dtreat:first.treat::2004:year::2005:lpop_dm  0.025113   0.017904  1.402661 #> .Dtreat:first.treat::2004:year::2006:lpop_dm  0.050735   0.021070  2.407884 #> .Dtreat:first.treat::2004:year::2007:lpop_dm  0.011250   0.026617  0.422648 #> .Dtreat:first.treat::2006:year::2006:lpop_dm  0.038935   0.016472  2.363731 #> .Dtreat:first.treat::2006:year::2007:lpop_dm  0.038060   0.022477  1.693276 #> .Dtreat:first.treat::2007:year::2007:lpop_dm -0.019835   0.016198 -1.224528 #>                                                Pr(>|t|)     #> .Dtreat:first.treat::2004:year::2004         3.2860e-01     #> .Dtreat:first.treat::2004:year::2005         2.9279e-03 **  #> .Dtreat:first.treat::2004:year::2006         9.3851e-06 *** #> .Dtreat:first.treat::2004:year::2007         7.5694e-04 *** #> .Dtreat:first.treat::2006:year::2006         8.9318e-01     #> .Dtreat:first.treat::2006:year::2007         4.0798e-02 *   #> .Dtreat:first.treat::2007:year::2007         1.0866e-02 *   #> .Dtreat:first.treat::2004:year::2004:lpop_dm 7.9252e-01     #> .Dtreat:first.treat::2004:year::2005:lpop_dm 1.6134e-01     #> .Dtreat:first.treat::2004:year::2006:lpop_dm 1.6407e-02 *   #> .Dtreat:first.treat::2004:year::2007:lpop_dm 6.7273e-01     #> .Dtreat:first.treat::2006:year::2006:lpop_dm 1.8474e-02 *   #> .Dtreat:first.treat::2006:year::2007:lpop_dm 9.1027e-02 .   #> .Dtreat:first.treat::2007:year::2007:lpop_dm 2.2133e-01     #> ... 10 variables were removed because of collinearity (.Dtreat:first.treat::2006:year::2004, .Dtreat:first.treat::2006:year::2005 and 8 others [full set in $collin.var]) #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #> RMSE: 0.537131     Adj. R2: 0.87167  #>                  Within R2: 8.449e-4  # We can recover a variety of treatment effects of interest with the  # complementary emfx() function. For example: emfx(mod, type = \"event\") #>      Term    Contrast event   Effect Std. Error z value   Pr(>|z|)    2.5 % #> 1 .Dtreat mean(dY/dX)     0 -0.03321    0.01337  -2.484 0.01297951 -0.05941 #> 2 .Dtreat mean(dY/dX)     1 -0.05735    0.01715  -3.343 0.00082830 -0.09097 #> 3 .Dtreat mean(dY/dX)     2 -0.13787    0.03079  -4.477 7.5665e-06 -0.19823 #> 4 .Dtreat mean(dY/dX)     3 -0.10954    0.03232  -3.389 0.00070142 -0.17289 #>     97.5 % #> 1 -0.00701 #> 2 -0.02373 #> 3 -0.07751 #> 4 -0.04619 #>  #> Model type:  etwfe  #> Prediction type:  response"}]
