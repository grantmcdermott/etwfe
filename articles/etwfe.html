<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="etwfe">
<title>Introduction to etwfe • etwfe</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to etwfe">
<meta property="og:description" content="etwfe">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">etwfe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/etwfe.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grantmcdermott/etwfe/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to etwfe</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/grantmcdermott/etwfe/blob/HEAD/vignettes/etwfe.Rmd" class="external-link"><code>vignettes/etwfe.Rmd</code></a></small>
      <div class="d-none name"><code>etwfe.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>One of the canonical research designs for social scientists is the
so-called “differences-in-differences” (DiD) design.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Good textbook introductions to DiD are available &lt;a href="https://theeffectbook.net/ch-DifferenceinDifference.html" class="external-link"&gt;here&lt;/a&gt;
and &lt;a href="https://mixtape.scunning.com/09-difference_in_differences" class="external-link"&gt;here&lt;/a&gt;,
among many other places.&lt;/p&gt;'><sup>1</sup></a> Historically, the way
that applied researchers estimated DiD was in the form of a two-way
fixed effects (TWFE) regression. TWFE is basically just an interaction
effect between treatment and time, and might look something like the
following in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">*</span> <span class="va">time</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>This type of regression is easy to run and interpret, and for a long
time everyone was happy. But it was too good to last. A slew of smart
studies began appearing in the early 2020s, demonstrating that things
weren’t quite so simple. Among other things, the core interaction term
in a standard TWFE can provide a biased estimate of the true treatment
effect if the rollout of treatment was staggered over time (a very
common occurence).</p>
<p>Fortunately, just as econometricians were taking away one of our
favourite tools, they were kind enough to replace it with some new ones.
Among these, the proposed approach by <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3906345" class="external-link">Wooldridge
(2021)</a> is noteworthy. His idea might be paraphrased as stating that
the problem with TWFE is not that we were doing it in the first place,
but that we weren’t doing it <em>enough</em>. Which is to say that
instead of only including a single treatment × time interaction, we
should saturate our model with all possible interactions between
treatment and time variables, including treament cohorts, as well as
other covariates. Wooldridge (2021) refers to this idea as
<em>extended</em> TWFE—or, ETWFE—which is where this package takes its
name.</p>
<p>The Wooldridge ETWFE solution is intuitive and elegant. But it is
also rather tedious and error prone to code up manually. The
<strong>etwfe</strong> package aims to simplify the process by providing
convenience functions that do the work for you. <strong>etwfe</strong>
thus provides an R equivalent of the <a href="https://ideas.repec.org/c/boc/bocode/s459114.html" class="external-link"><code>JWDID</code></a>
Stata module and, indeed, shares some of the core design elements.</p>
</div>
<div class="section level2">
<h2 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h2>
<p>To demonstrate the core functionality of <strong>etwfe</strong>,
we’ll use the <a href="https://bcallaway11.github.io/did/reference/mpdta.html" class="external-link"><code>mpdta</code></a>
dataset on US teen employment from *the <strong>did</strong> package
(which you’ll need to install separately).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("did")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mpdta"</span>, package <span class="op">=</span> <span class="st">"did"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mpdta</span><span class="op">)</span></span>
<span><span class="co">#&gt;     year countyreal     lpop     lemp first.treat treat</span></span>
<span><span class="co">#&gt; 866 2003       8001 5.896761 8.461469        2007     1</span></span>
<span><span class="co">#&gt; 841 2004       8001 5.896761 8.336870        2007     1</span></span>
<span><span class="co">#&gt; 842 2005       8001 5.896761 8.340217        2007     1</span></span>
<span><span class="co">#&gt; 819 2006       8001 5.896761 8.378161        2007     1</span></span>
<span><span class="co">#&gt; 827 2007       8001 5.896761 8.487352        2007     1</span></span>
<span><span class="co">#&gt; 937 2003       8019 2.232377 4.997212        2007     1</span></span></code></pre></div>
<p>In the examples that follow, our goal is to estimate the effect of
treatment <code>treat</code> on (log) employment <code>lemp</code>.
Notice that the panel ID is at the county level <code>countyreal</code>,
but treatment was staggered across cohorts <code>first.treat</code> so
that a group of counties were treated at the same time. In addition to
these staggered treatment effects, we also observe (log) population
<code>lpop</code> as a potential, time-invariant control.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The time-invariance property is important; time-varying
controls are not allowed in the ETWFE framework. But you can also omit
controls if you don’t have any.&lt;/p&gt;"><sup>2</sup></a></p>
</div>
<div class="section level2">
<h2 id="basic-useage">Basic useage<a class="anchor" aria-label="anchor" href="#basic-useage"></a>
</h2>
<p>Okay, let’s load <strong>etwfe</strong> and work through its basic
functionality. Given the package name, it won’t surprise you to know
that the key estimating function is <code><a href="../reference/etwfe.html">etwfe()</a></code>. Here’s how it
would look for our example dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grantmcdermott/etwfe" class="external-link">etwfe</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="../reference/etwfe.html">etwfe</a></span><span class="op">(</span></span>
<span>    fml  <span class="op">=</span> <span class="va">lemp</span> <span class="op">~</span> <span class="va">lpop</span>, <span class="co"># outcome ~ (time-invariant) controls</span></span>
<span>    tvar <span class="op">=</span> <span class="va">year</span>,        <span class="co"># time variable</span></span>
<span>    gvar <span class="op">=</span> <span class="va">first.treat</span>, <span class="co"># group variable</span></span>
<span>    data <span class="op">=</span> <span class="va">mpdta</span>,       <span class="co"># dataset</span></span>
<span>    vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span>  <span class="co"># vcov adjustment (here: clustered)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>There are a few things to say about our <code><a href="../reference/etwfe.html">etwfe()</a></code> argument
choices and other function options, but we’ll leave those details aside
until a bit later. Right now, just know that all of the above arguments
are required except <code>vcov</code> (though I generally recommend it
too, since we probably want to cluster our standard errors at the
individual unit level).</p>
<p>Let’s take a look at our model object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span></span>
<span><span class="co">#&gt; OLS estimation, Dep. Var.: lemp</span></span>
<span><span class="co">#&gt; Observations: 2,500 </span></span>
<span><span class="co">#&gt; Fixed-effects: first.treat: 4,  year: 5</span></span>
<span><span class="co">#&gt; Varying slopes: lpop (first.treat: 4),  lpop (year: 5)</span></span>
<span><span class="co">#&gt; Standard-errors: Clustered (countyreal) </span></span>
<span><span class="co">#&gt;                                               Estimate Std. Error   t value</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2004         -0.021248   0.021728 -0.977890</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2005         -0.081850   0.027375 -2.989963</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2006         -0.137870   0.030795 -4.477097</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2007         -0.109539   0.032322 -3.389024</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2006          0.002537   0.018883  0.134344</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2007         -0.045093   0.021987 -2.050907</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2007:year::2007         -0.045955   0.017975 -2.556568</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2004:lpop_dm  0.004628   0.017584  0.263184</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2005:lpop_dm  0.025113   0.017904  1.402661</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2006:lpop_dm  0.050735   0.021070  2.407884</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2007:lpop_dm  0.011250   0.026617  0.422648</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2006:lpop_dm  0.038935   0.016472  2.363731</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2007:lpop_dm  0.038060   0.022477  1.693276</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2007:year::2007:lpop_dm -0.019835   0.016198 -1.224528</span></span>
<span><span class="co">#&gt;                                                Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2004         3.2860e-01    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2005         2.9279e-03 ** </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2006         9.3851e-06 ***</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2007         7.5694e-04 ***</span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2006         8.9318e-01    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2007         4.0798e-02 *  </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2007:year::2007         1.0866e-02 *  </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2004:lpop_dm 7.9252e-01    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2005:lpop_dm 1.6134e-01    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2006:lpop_dm 1.6407e-02 *  </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2004:year::2007:lpop_dm 6.7273e-01    </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2006:lpop_dm 1.8474e-02 *  </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2006:year::2007:lpop_dm 9.1027e-02 .  </span></span>
<span><span class="co">#&gt; .Dtreat:first.treat::2007:year::2007:lpop_dm 2.2133e-01    </span></span>
<span><span class="co">#&gt; ... 10 variables were removed because of collinearity (.Dtreat:first.treat::2006:year::2004, .Dtreat:first.treat::2006:year::2005 and 8 others [full set in $collin.var])</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; RMSE: 0.537131     Adj. R2: 0.87167 </span></span>
<span><span class="co">#&gt;                  Within R2: 8.449e-4</span></span></code></pre></div>
<p>What <code><a href="../reference/etwfe.html">etwfe()</a></code> has done underneath the hood is construct a
treatment dummy variable <code>.Dtreat</code> and saturated it together
with the other variables of interest as a set of multiway interaction
terms.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;It has also demeaned the &lt;code&gt;lpop&lt;/code&gt; control
variable, but that again is something we’ll get back too later. It’s not
particularly important for interpreting the final results.&lt;/p&gt;"><sup>3</sup></a></p>
<p>You may also have noticed that our <code><a href="../reference/etwfe.html">etwfe()</a></code> call returns
a standard <a href="https://lrberge.github.io/fixest/" class="external-link"><strong>fixest</strong></a>
object, since this is what it uses to perform the underlying estimation.
All of the associated methods and functions from the
<strong>fixest</strong> package are thus compatible with our model
object. For example, we *could plot the raw regression coefficients with
<code><a href="https://lrberge.github.io/fixest/reference/coefplot.html" class="external-link">fixest::coefplot()</a></code>, or print them to a nice regression
table with <code><a href="https://lrberge.github.io/fixest/reference/etable.html" class="external-link">fixest::etable()</a></code>. However, the raw coefficients
from an <code><a href="../reference/etwfe.html">etwfe()</a></code> estimation are not particularly meaningful
in of themselves. Remember that these are complex multiway interaction
terms that are probably hard to to interpret on their own. So, we
probably want to aggregate them along some dimension of interest instead
(e.g., by groups or time, or as an event study). A natural way to
perform these aggregations is by recovering the appropriate marginal
effects. The <strong>etwfe</strong> package provides another convenience
function for doing so: <code><a href="../reference/emfx.html">emfx()</a></code>, which is a thin(ish) wrapper
around <code><a href="https://vincentarelbundock.github.io/marginaleffects/reference/marginaleffects.html" class="external-link">marginaleffects::marginaleffects()</a></code>.</p>
<p>For example, we can recover the average treatment effect as
follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/emfx.html">emfx</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Term    Contrast .Dtreat   Effect Std. Error z value   Pr(&gt;|z|)    2.5 %</span></span>
<span><span class="co">#&gt; 1 .Dtreat mean(dY/dX)       1 -0.05063     0.0125   -4.05 5.1167e-05 -0.07513</span></span>
<span><span class="co">#&gt;     97.5 %</span></span>
<span><span class="co">#&gt; 1 -0.02613</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model type:  etwfe </span></span>
<span><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
<p>Or, we can recover the dynamic treatment effects <em>a la</em> an
event study by invoking the type argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/emfx.html">emfx</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"event"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Term    Contrast event   Effect Std. Error z value   Pr(&gt;|z|)    2.5 %</span></span>
<span><span class="co">#&gt; 1 .Dtreat mean(dY/dX)     0 -0.03321    0.01337  -2.484 0.01297951 -0.05941</span></span>
<span><span class="co">#&gt; 2 .Dtreat mean(dY/dX)     1 -0.05735    0.01715  -3.343 0.00082830 -0.09097</span></span>
<span><span class="co">#&gt; 3 .Dtreat mean(dY/dX)     2 -0.13787    0.03079  -4.477 7.5665e-06 -0.19823</span></span>
<span><span class="co">#&gt; 4 .Dtreat mean(dY/dX)     3 -0.10954    0.03232  -3.389 0.00070142 -0.17289</span></span>
<span><span class="co">#&gt;     97.5 %</span></span>
<span><span class="co">#&gt; 1 -0.00701</span></span>
<span><span class="co">#&gt; 2 -0.02373</span></span>
<span><span class="co">#&gt; 3 -0.07751</span></span>
<span><span class="co">#&gt; 4 -0.04619</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model type:  etwfe </span></span>
<span><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
<p>Other types of aggregations include “calendar” (here: treatment by
year effects) and “group” (here: treatment by cohort).</p>
</div>
<div class="section level2">
<h2 id="other-families">Other families<a class="anchor" aria-label="anchor" href="#other-families"></a>
</h2>
<p>A key feature of the ETWFE method proposed by Wooldridge (2021) is
that it supports nonlinear model (distribution / link) families. Here’s
a brief example, where we recast our earlier event-study as a Poisson
regression.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mpdta</span><span class="op">$</span><span class="va">emp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mpdta</span><span class="op">$</span><span class="va">lemp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/etwfe.html">etwfe</a></span><span class="op">(</span></span>
<span>  <span class="va">emp</span> <span class="op">~</span> <span class="va">lpop</span>, tvar <span class="op">=</span> <span class="va">year</span>, gvar <span class="op">=</span> <span class="va">first.treat</span>, data <span class="op">=</span> <span class="va">mpdta</span>, vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/emfx.html">emfx</a></span><span class="op">(</span><span class="st">"event"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Term    Contrast event  Effect Std. Error  z value   Pr(&gt;|z|)   2.5 %</span></span>
<span><span class="co">#&gt; 1 .Dtreat mean(dY/dX)     0 -22.849      16.24 -1.40674 0.15950581  -54.68</span></span>
<span><span class="co">#&gt; 2 .Dtreat mean(dY/dX)     1   3.654      43.48  0.08405 0.93301382  -81.56</span></span>
<span><span class="co">#&gt; 3 .Dtreat mean(dY/dX)     2 -71.521      21.28 -3.36144 0.00077537 -113.22</span></span>
<span><span class="co">#&gt; 4 .Dtreat mean(dY/dX)     3 -97.798      26.50 -3.69045 0.00022386 -149.74</span></span>
<span><span class="co">#&gt;    97.5 %</span></span>
<span><span class="co">#&gt; 1   8.986</span></span>
<span><span class="co">#&gt; 2  88.865</span></span>
<span><span class="co">#&gt; 3 -29.819</span></span>
<span><span class="co">#&gt; 4 -45.858</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model type:  etwfe </span></span>
<span><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-is-etwfe-doing-under-the-hood">What is etwfe doing under the hood?<a class="anchor" aria-label="anchor" href="#what-is-etwfe-doing-under-the-hood"></a>
</h2>
<p>Now that you’ve seen <strong>etwfe</strong> in action, let’s circle
back to what the package is doing under the hood. This section isn’t
necessary for you to use any of the functions. Feel free to skip it. But
a review of the internal details should help you to optimize for
different scenarios and also give you an understanding of
<strong>etwfe’s</strong> default choices.</p>
<p>As I’ve stated several times, the Wooldridge ETWFE approach basically
involves saturataing the regression with interaction effects. You can
easily grab the formula of an estimated model to see for yourself.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">fml_all</span></span>
<span><span class="co">#&gt; $linear</span></span>
<span><span class="co">#&gt; lemp ~ .Dtreat:i(first.treat, i.year, ref = 0, ref2 = 2003)/lpop_dm</span></span>
<span><span class="co">#&gt; &lt;environment: 0x55d390de5c18&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixef</span></span>
<span><span class="co">#&gt; ~first.treat + first.treat[[lpop]] + year + year[[lpop]]</span></span></code></pre></div>
<p>At this point, however, you may notice a few things. The first is
that our formula references several variables that aren’t in the
original dataset. An obvious one is the <code>.Dtreat</code> treatment
dummy. A more subtle one is <code>lpop_dm</code>, which is the
<em>demeaned</em> (i.e., group-centered) version of our
<code>lpop</code> control variable. All (time-invariant) control
variables have to be demeaned before they are interacted in the ETWFE
setting. Here’s how you could have constructed the dataset ahead of time
and estimated the ETWFE regression manually:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First construct the dataset</span></span>
<span><span class="va">mpdta2</span> <span class="op">=</span> <span class="va">mpdta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span>
<span>    .Dtreat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="va">first.treat</span> <span class="op">&amp;</span> <span class="va">first.treat</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    lpop_dm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ave.html" class="external-link">ave</a></span><span class="op">(</span><span class="va">lpop</span>, <span class="va">first.treat</span>, <span class="va">year</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Then estimate the manual version of etwfe</span></span>
<span><span class="va">mod2</span> <span class="op">=</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span></span>
<span>  <span class="va">lemp</span> <span class="op">~</span> <span class="va">.Dtreat</span><span class="op">:</span><span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, <span class="va">i.year</span>, ref <span class="op">=</span> <span class="fl">0</span>, ref2 <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">/</span> <span class="va">lpop_dm</span> <span class="op">|</span></span>
<span>    <span class="va">first.treat</span><span class="op">[</span><span class="va">lpop</span><span class="op">]</span> <span class="op">+</span> <span class="va">year</span><span class="op">[</span><span class="va">lpop</span><span class="op">]</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mpdta2</span>,</span>
<span>  vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The variables '.Dtreat:first.treat::2006:year::2004', '.Dtreat:first.treat::2006:year::2005' and eight others have been removed because of collinearity (see $collin.var).</span></span>
<span></span>
<span><span class="co"># Confirm that they are the same</span></span>
<span><span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html" class="external-link">etable</a></span><span class="op">(</span><span class="st">'etwfe'</span> <span class="op">=</span> <span class="va">mod</span>, <span class="st">'manual'</span> <span class="op">=</span> <span class="va">mod2</span>, signif.code <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                 etwfe</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                Yes</span></span>
<span><span class="co">#&gt; lpop (year)                                                       Yes</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.00084</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                                manual</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                Yes</span></span>
<span><span class="co">#&gt; lpop (year)                                                       Yes</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.00084</span></span></code></pre></div>
<p>If you are a regular <strong>fixest</strong> user, you may have
noticed that we’ve been invoking its <a href="https://lrberge.github.io/fixest/articles/fixest_walkthrough.html#varying-slopes-fex" class="external-link">varying
slopes</a> syntax in the fixed-effect slot (i.e.,
<code>first.treat[lpop]</code> and <code>year[lpop]</code>). The reason
for this is part practical, part philosophical. From a practical
perspective, <code>factor_var[numeric_var]</code> is equivalent to base
R’s <code>factor_var/numeric_var</code> “nesting” syntax but is much
faster for high-dimensional factors.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;We won’t see a speed-up for this small dataset, but it
can make a signficant difference for large datasets.&lt;/p&gt;"><sup>4</sup></a> From a philosphical perspective,
<strong>etwfe</strong> tries to limit the amount of extraneous
information that it reports to users. Most of the interaction effects in
the ETWFE framework are just acting as controls. By relegating them to
the fixed-effects slot, we can avoid polluting the user’s console with a
load of extra coefficients. Nonetheless, we can control this behaviour
with the <code>fe</code> (“fixed effects”) argument. Consider the
following options and their manual equivalents.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fe = "feo" (fixed effects only)</span></span>
<span><span class="va">mod_feo</span> <span class="op">=</span> <span class="fu"><a href="../reference/etwfe.html">etwfe</a></span><span class="op">(</span></span>
<span>  <span class="va">lemp</span> <span class="op">~</span> <span class="va">lpop</span>, tvar <span class="op">=</span> <span class="va">year</span>, gvar <span class="op">=</span> <span class="va">first.treat</span>, data <span class="op">=</span> <span class="va">mpdta</span>, vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span>,</span>
<span>  fe <span class="op">=</span> <span class="st">"feo"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># ... which is equivalent to the manual regression</span></span>
<span><span class="va">mod_feo2</span> <span class="op">=</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span></span>
<span>  <span class="va">lemp</span> <span class="op">~</span> <span class="va">.Dtreat</span><span class="op">:</span><span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, <span class="va">i.year</span>, ref <span class="op">=</span> <span class="fl">0</span>, ref2 <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">/</span> <span class="va">lpop_dm</span> <span class="op">+</span></span>
<span>    <span class="va">lpop</span> <span class="op">+</span> <span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, <span class="va">lpop</span>, ref <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">i</span><span class="op">(</span><span class="va">year</span>, <span class="va">lpop</span>, ref <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="va">first.treat</span> <span class="op">+</span> <span class="va">year</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mpdta2</span>, vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fe = "none"</span></span>
<span><span class="va">mod_none</span> <span class="op">=</span> <span class="fu"><a href="../reference/etwfe.html">etwfe</a></span><span class="op">(</span></span>
<span>  <span class="va">lemp</span> <span class="op">~</span> <span class="va">lpop</span>, tvar <span class="op">=</span> <span class="va">year</span>, gvar <span class="op">=</span> <span class="va">first.treat</span>, data <span class="op">=</span> <span class="va">mpdta</span>, vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span>,</span>
<span>  fe <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># ... which is equivalent to the manual regression</span></span>
<span><span class="va">mod_none2</span> <span class="op">=</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span></span>
<span>  <span class="va">lemp</span> <span class="op">~</span> <span class="va">.Dtreat</span><span class="op">:</span><span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, <span class="va">i.year</span>, ref <span class="op">=</span> <span class="fl">0</span>, ref2 <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">/</span> <span class="va">lpop_dm</span> <span class="op">+</span></span>
<span>    <span class="va">lpop</span> <span class="op">+</span> <span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, <span class="va">lpop</span>, ref <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">i</span><span class="op">(</span><span class="va">year</span>, <span class="va">lpop</span>, ref <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">i</span><span class="op">(</span><span class="va">first.treat</span>, ref <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">i</span><span class="op">(</span><span class="va">year</span>, ref <span class="op">=</span> <span class="fl">2003</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mpdta2</span>, vcov <span class="op">=</span> <span class="op">~</span><span class="va">countyreal</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I’ll leave it up to you to pass any of these to models
<code>emfx</code> to confirm that they give correct aggregated treatment
effects. But we can quickly demonstrate in a regression table that they
all return the same raw coefficients.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html" class="external-link">etable</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod2</span>, <span class="va">mod_feo</span>, <span class="va">mod_feo2</span>, <span class="va">mod_none</span>, <span class="va">mod_none2</span>, signif.code <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                   mod</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                                 </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                                            </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                                            </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                                            </span></span>
<span><span class="co">#&gt; lpop x year = 2004                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2005                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2006                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2007                                                   </span></span>
<span><span class="co">#&gt; Constant                                                             </span></span>
<span><span class="co">#&gt; first.treat = 2004                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2006                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2007                                                   </span></span>
<span><span class="co">#&gt; year = 2004                                                          </span></span>
<span><span class="co">#&gt; year = 2005                                                          </span></span>
<span><span class="co">#&gt; year = 2006                                                          </span></span>
<span><span class="co">#&gt; year = 2007                                                          </span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                Yes</span></span>
<span><span class="co">#&gt; lpop (year)                                                       Yes</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.00084</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                                  mod2</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                                 </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                                            </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                                            </span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                                            </span></span>
<span><span class="co">#&gt; lpop x year = 2004                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2005                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2006                                                   </span></span>
<span><span class="co">#&gt; lpop x year = 2007                                                   </span></span>
<span><span class="co">#&gt; Constant                                                             </span></span>
<span><span class="co">#&gt; first.treat = 2004                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2006                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2007                                                   </span></span>
<span><span class="co">#&gt; year = 2004                                                          </span></span>
<span><span class="co">#&gt; year = 2005                                                          </span></span>
<span><span class="co">#&gt; year = 2006                                                          </span></span>
<span><span class="co">#&gt; year = 2007                                                          </span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                Yes</span></span>
<span><span class="co">#&gt; lpop (year)                                                       Yes</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.00084</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                               mod_feo</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                   1.065 (0.0218)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                             0.0510 (0.0378)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                            -0.0411 (0.0474)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                             0.0555 (0.0392)</span></span>
<span><span class="co">#&gt; lpop x year = 2004                                    0.0110 (0.0076)</span></span>
<span><span class="co">#&gt; lpop x year = 2005                                    0.0207 (0.0081)</span></span>
<span><span class="co">#&gt; lpop x year = 2006                                    0.0105 (0.0108)</span></span>
<span><span class="co">#&gt; lpop x year = 2007                                    0.0209 (0.0118)</span></span>
<span><span class="co">#&gt; Constant                                                             </span></span>
<span><span class="co">#&gt; first.treat = 2004                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2006                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2007                                                   </span></span>
<span><span class="co">#&gt; year = 2004                                                          </span></span>
<span><span class="co">#&gt; year = 2005                                                          </span></span>
<span><span class="co">#&gt; year = 2006                                                          </span></span>
<span><span class="co">#&gt; year = 2007                                                          </span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                 No</span></span>
<span><span class="co">#&gt; lpop (year)                                                        No</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.86946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                              mod_feo2</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                   1.065 (0.0218)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                             0.0510 (0.0378)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                            -0.0411 (0.0474)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                             0.0555 (0.0392)</span></span>
<span><span class="co">#&gt; lpop x year = 2004                                    0.0110 (0.0076)</span></span>
<span><span class="co">#&gt; lpop x year = 2005                                    0.0207 (0.0081)</span></span>
<span><span class="co">#&gt; lpop x year = 2006                                    0.0105 (0.0108)</span></span>
<span><span class="co">#&gt; lpop x year = 2007                                    0.0209 (0.0118)</span></span>
<span><span class="co">#&gt; Constant                                                             </span></span>
<span><span class="co">#&gt; first.treat = 2004                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2006                                                   </span></span>
<span><span class="co">#&gt; first.treat = 2007                                                   </span></span>
<span><span class="co">#&gt; year = 2004                                                          </span></span>
<span><span class="co">#&gt; year = 2005                                                          </span></span>
<span><span class="co">#&gt; year = 2006                                                          </span></span>
<span><span class="co">#&gt; year = 2007                                                          </span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                       Yes</span></span>
<span><span class="co">#&gt; year                                                              Yes</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                 No</span></span>
<span><span class="co">#&gt; lpop (year)                                                        No</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                     0.86946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                              mod_none</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                   1.065 (0.0218)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                             0.0510 (0.0378)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                            -0.0411 (0.0474)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                             0.0555 (0.0392)</span></span>
<span><span class="co">#&gt; lpop x year = 2004                                    0.0110 (0.0076)</span></span>
<span><span class="co">#&gt; lpop x year = 2005                                    0.0207 (0.0081)</span></span>
<span><span class="co">#&gt; lpop x year = 2006                                    0.0105 (0.0108)</span></span>
<span><span class="co">#&gt; lpop x year = 2007                                    0.0209 (0.0118)</span></span>
<span><span class="co">#&gt; Constant                                               2.260 (0.0881)</span></span>
<span><span class="co">#&gt; first.treat = 2004                                    0.0383 (0.1538)</span></span>
<span><span class="co">#&gt; first.treat = 2006                                    0.4613 (0.2130)</span></span>
<span><span class="co">#&gt; first.treat = 2007                                   -0.2861 (0.1672)</span></span>
<span><span class="co">#&gt; year = 2004                                          -0.0902 (0.0307)</span></span>
<span><span class="co">#&gt; year = 2005                                          -0.1105 (0.0326)</span></span>
<span><span class="co">#&gt; year = 2006                                          -0.0517 (0.0402)</span></span>
<span><span class="co">#&gt; year = 2007                                          -0.0575 (0.0453)</span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                        No</span></span>
<span><span class="co">#&gt; year                                                               No</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                 No</span></span>
<span><span class="co">#&gt; lpop (year)                                                        No</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                          --</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                             mod_none2</span></span>
<span><span class="co">#&gt; Dependent Var.:                                                  lemp</span></span>
<span><span class="co">#&gt;                                                                      </span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2004           -0.0213 (0.0217)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2005           -0.0819 (0.0274)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2006           -0.1379 (0.0308)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2004 x year = 2007           -0.1095 (0.0323)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2006            0.0025 (0.0189)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2006 x year = 2007           -0.0451 (0.0220)</span></span>
<span><span class="co">#&gt; .Dtreat x first.treat = 2007 x year = 2007           -0.0459 (0.0180)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2004  0.0046 (0.0176)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2005  0.0251 (0.0179)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2006  0.0507 (0.0211)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2004 x year = 2007  0.0112 (0.0266)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2006  0.0389 (0.0165)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2006 x year = 2007  0.0381 (0.0225)</span></span>
<span><span class="co">#&gt; .Dtreat x lpop_dm x first.treat = 2007 x year = 2007 -0.0198 (0.0162)</span></span>
<span><span class="co">#&gt; lpop                                                   1.065 (0.0218)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2004                             0.0510 (0.0378)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2006                            -0.0411 (0.0474)</span></span>
<span><span class="co">#&gt; lpop x first.treat = 2007                             0.0555 (0.0392)</span></span>
<span><span class="co">#&gt; lpop x year = 2004                                    0.0110 (0.0076)</span></span>
<span><span class="co">#&gt; lpop x year = 2005                                    0.0207 (0.0081)</span></span>
<span><span class="co">#&gt; lpop x year = 2006                                    0.0105 (0.0108)</span></span>
<span><span class="co">#&gt; lpop x year = 2007                                    0.0209 (0.0118)</span></span>
<span><span class="co">#&gt; Constant                                               2.260 (0.0881)</span></span>
<span><span class="co">#&gt; first.treat = 2004                                    0.0383 (0.1538)</span></span>
<span><span class="co">#&gt; first.treat = 2006                                    0.4613 (0.2130)</span></span>
<span><span class="co">#&gt; first.treat = 2007                                   -0.2861 (0.1672)</span></span>
<span><span class="co">#&gt; year = 2004                                          -0.0902 (0.0307)</span></span>
<span><span class="co">#&gt; year = 2005                                          -0.1105 (0.0326)</span></span>
<span><span class="co">#&gt; year = 2006                                          -0.0517 (0.0402)</span></span>
<span><span class="co">#&gt; year = 2007                                          -0.0575 (0.0453)</span></span>
<span><span class="co">#&gt; Fixed-Effects:                                       ----------------</span></span>
<span><span class="co">#&gt; first.treat                                                        No</span></span>
<span><span class="co">#&gt; year                                                               No</span></span>
<span><span class="co">#&gt; Varying Slopes:                                      ----------------</span></span>
<span><span class="co">#&gt; lpop (first.treat)                                                 No</span></span>
<span><span class="co">#&gt; lpop (year)                                                        No</span></span>
<span><span class="co">#&gt; ________________________________________             ________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                                        by: countyreal</span></span>
<span><span class="co">#&gt; Observations                                                    2,500</span></span>
<span><span class="co">#&gt; R2                                                            0.87321</span></span>
<span><span class="co">#&gt; Within R2                                                          --</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Grant McDermott.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
